$(function(){$('[data-toggle="tooltip"]').tooltip()}),jQuery(document).ready(function(){jQuery(".scrollbar-inner").scrollbar()}),$(document).ready(function(){var t=!1,o=!1,e=0,a=0
t||($toggle=$(".sidenav-toggler"),$toggle.click(function(){1==e?($("html").removeClass("nav_open"),$toggle.removeClass("toggled"),e=0):($("html").addClass("nav_open"),$toggle.addClass("toggled"),e=1)}),t=!0),o||($topbar=$(".topbar-toggler"),$topbar.click(function(){1==a?($("html").removeClass("topbar_open"),$topbar.removeClass("toggled"),a=0):($("html").addClass("topbar_open"),$topbar.addClass("toggled"),a=1)}),o=!0),$('[data-select="checkbox"]').change(function(){$target=$(this).attr("data-target"),$($target).prop("checked",$(this).prop("checked"))})})


$(document).ready(function()
{
    LoadNotifyCount();
	// FOR HOME LOAN SERVICE

	$(".ad_verify_mobile").click(function(e)
	{
		if ( !$("#adname").val() || !$("#admobile").val() )
		{
			alert("Please Mobile Number");
		}
		/*else if( ($("#admobile").val() !== '9082804376') )
		{
		    $("#adotp_message").html('<div class="alert alert-danger alert-dismissible"><button type="button" class="close" data-dismiss="alert">&times;</button><strong>Only Admins can login on this server!</strong></div>');
		}*/
		else
		{
			/*$(this).remove();
			$(".ad_otp_field, .ad_otp_btn").css("display", "block");
			$(".ad_otp_field, .ad_otp_btn").css("height", "100%");
			$(".ad_otp_btn").attr("disabled", "disabled");
			$("#adotp").focus();*/

			$.ajax({
				type: "POST",
				url: "send_otp_ad.php",
				data:{
					name: $('#adname').val(),
					mobile: $('#admobile').val()
					// message: $('#message').val()
				},
				success: function(data){
					console.log(data);
					if($.trim(data) === 'false')
					{
					    $("#adotp_message").html('<div class="alert alert-danger alert-dismissible"><button type="button" class="close" data-dismiss="alert">&times;</button><strong>Only Admins can login on this server!</strong></div>');
					}
					else
					{
					    $(".ad_verify_mobile").remove();
            			$(".ad_otp_field, .ad_otp_btn").css("display", "block");
            			$(".ad_otp_field, .ad_otp_btn").css("height", "100%");
            // 			$(".ad_otp_btn").attr("disabled", "disabled");
            			$("#adotp").focus();
            			
					    //$("#adotp_message").html(data);
						var timer2 = "5:01";
						var interval = setInterval(function()
						{
						  var timer = timer2.split(':');
						  //by parsing integer, I avoid all extra string processing
						  var minutes = parseInt(timer[0], 10);
						  var seconds = parseInt(timer[1], 10);
						  --seconds;
						  minutes = (seconds < 0) ? --minutes : minutes;
						  if (minutes < 0) clearInterval(interval);
						  seconds = (seconds < 0) ? 59 : seconds;
						  seconds = (seconds < 10) ? '0' + seconds : seconds;

						  if (minutes < 0) {
						  		$(".ad_count_time").html("");
						  		$(".ad_resend").removeClass("disabled");
						        clearInterval(interval);
						    } else {
						        $('.ad_count_time').html(minutes + ':' + seconds);
						        timer2 = minutes + ':' + seconds;
						    }
						}, 1000);
					}
				}
			});
		}		
	});
	
	/*$("#adotp").on("input", function()
	{
	    if( $(this).val().length == 6 )
	    {
	        $.ajax({
        		type: "POST",
        		url: "check-admin-otp.php",
        		data: {otp:$(this).val()},
        		success: function(response)
        		{
        			// console.log(response);
        			// alert("Status Changed");
        			$(".ad_otp_btn").removeAttr("disabled");
        			$("#otp_error").html(response);
        		}
        	})
	    }
	});*/

	$(".ad_otp_btn").click(function(e)
	{
		// e.preventDefault();
		if(!$('#adotp').val())
		{
		    alert("Please Enter OTP to login");
		}
		else
		{
		    $.ajax({
				type: "POST",
				url: "verify_otp_ad.php",
				cache: false,
				data:{
					name: $('#adname').val(),
					mobile: $('#admobile').val(),
					otp: $('#adotp').val()
				},
				success: function(data){
				// 	console.log(data);
					$("#adotp_message").html(data);
					//$('#adname').val("");
					//$('#admobile').val("");
					$('#adotp').val("");
					//$('.adminlogin-form').remove();
				}
			});
		}
	});
	
	$(".ad_pass_btn").click(function(e)
	{
		// e.preventDefault();
		if(!$('#adpass').val())
		{
		    alert("Please Enter Password to login");
		}
		else
		{
		    $.ajax({
				type: "POST",
				url: "login_with_pass.php",
				cache: false,
				data:{
					name: $('#adname').val(),
					mobile: $('#admobile').val(),
					pass: $('#adpass').val()
				},
				success: function(data){
				 	//console.log(data);
					$("#adotp_message").html(data);
					//$('#adname').val("");
					//$('#admobile').val("");
					$('#adpass').val("");
					//$('.adminlogin-form').remove();
				}
			});
		}
	});

	$(".ad_resend").click(function(e)
	{
	    $(".ad_resend").addClass("disabled");
		$.ajax({
				type: "POST",
				url: "resend_otp_ad.php",
				data:{
					name: $('#adname').val(),
					mobile: $('#admobile').val()
				},
				success: function(data){
					console.log(data);
					var timer2 = "5:01";
					var interval = setInterval(function()
					{
					  var timer = timer2.split(':');
					  //by parsing integer, I avoid all extra string processing
					  var minutes = parseInt(timer[0], 10);
					  var seconds = parseInt(timer[1], 10);
					  --seconds;
					  minutes = (seconds < 0) ? --minutes : minutes;
					  if (minutes < 0) clearInterval(interval);
					  seconds = (seconds < 0) ? 59 : seconds;
					  seconds = (seconds < 10) ? '0' + seconds : seconds;
					  //minutes = (minutes < 10) ?  minutes : minutes;
					  // $('.ad_count_time').html(minutes + ':' + seconds);
					  // timer2 = minutes + ':' + seconds;

					  if (minutes < 0) {
					  		$(".ad_count_time").html("");
					  		$(".ad_resend").removeClass("disabled");
					        clearInterval(interval);
					    } else {
					        $('.ad_count_time').html(minutes + ':' + seconds);
					        timer2 = minutes + ':' + seconds;
					    }
					}, 1000);
				}
			});
	});
});

function updateHStatus(val, id)
{
	$.ajax({
		type: "POST",
		url: "update-header-status.php",
		// data:'status='+val+'&hid='+id,
		data: {status:val, hid:id},
		success: function(response)
		{
			// console.log(response);
			alert("Status Changed");
		}
	})
}

function updateSTStatus(val, id)
{
	$.ajax({
		type: "POST",
		url: "update-staff-status.php",
		// data:'status='+val+'&hid='+id,
		data: {status:val, sid:id},
		success: function(response)
		{
			// console.log(response);
			alert("Status Changed");
		}
	})
}

function deleteheader(id)
{
	if (confirm("Are you sure you want to delete ?") == true)
	{
		$.ajax({
			type: "POST",
			url: "delete-header.php",
			// data:'status='+val+'&hid='+id,
			data: {hid:id},
			success: function(response)
			{
				// console.log(response);
				alert("Deleted Successfully");
				window.location.href='header-section.php'; 
			}
		});
	}	
}

function deleteregister(id)
{
	if (confirm("Are you sure you want to delete ?") == true)
	{
		$.ajax({
			type: "POST",
			url: "delete-register.php",
			// data:'status='+val+'&hid='+id,
			data: {rid:id},
			success: function(response)
			{
				// console.log(response);
				alert("Data Deleted Successfully");
				window.location.href='index1.php'; 
			}
		});
	}	
}

function deletestaff(id)
{
	if (confirm("Are you sure you want to delete ?") == true)
	{
		$.ajax({
			type: "POST",
			url: "delete-staff.php",
			// data:'status='+val+'&hid='+id,
			data: {sid:id},
			success: function(response)
			{
				// console.log(response);
				alert("Deleted Successfully");
				window.location.href='staff.php'; 
			}
		});
	}	
}

function deleteagent(id)
{
	if (confirm("Are you sure you want to delete ?") == true)
	{
		$.ajax({
			type: "POST",
			url: "delete-agent.php",
			// data:'status='+val+'&hid='+id,
			data: {aid:id},
			success: function(response)
			{
				// console.log(response);
				alert("Deleted Successfully");
				window.location.href='agent.php'; 
			}
		});
	}	
}

function deletework(id)
{
	if (confirm("Are you sure you want to delete ?") == true)
	{
		$.ajax({
			type: "POST",
			url: "delete-work.php",
			// data:'status='+val+'&hid='+id,
			data: {wid:id},
			success: function(response)
			{
				// console.log(response);
				alert("Deleted Successfully");
				window.location.href='work-service.php'; 
			}
		});
	}	
}

function delete_enquiry(id)
{
	if (confirm("Are you sure you want to delete ?") == true)
	{
		$.ajax({
			type: "POST",
			url: "delete-enquiry.php",
			// data:'status='+val+'&hid='+id,
			data: {eid:id},
			success: function(response)
			{
				// console.log(response);
				alert("Deleted Successfully");
				window.location.href='enquiry.php'; 
			}
		});
	}	
}

function deleterecordstatus(id)
{
	if (confirm("Are you sure you want to delete ?") == true)
	{
		$.ajax({
			type: "POST",
			url: "delete-recordstatus.php",
			// data:'status='+val+'&hid='+id,
			data: {rsid:id},
			success: function(response)
			{
				// console.log(response);
				alert("Deleted Successfully");
				window.location.href='record_status.php'; 
			}
		});
	}	
}

function deletelabels(id)
{
	if (confirm("Are you sure you want to delete ?") == true)
	{
		$.ajax({
			type: "POST",
			url: "delete-labels.php",
			// data:'status='+val+'&hid='+id,
			data: {lid:id},
			success: function(response)
			{
				// console.log(response);
				alert("Deleted Successfully");
				window.location.href='labels.php'; 
			}
		});
	}	
}

function CheckOldPass(val, sid)
{
	$.ajax({
		type: "POST",
		url: "check-old-pass.php",
		// data:'status='+val+'&hid='+id,
		data: {pass:val, sid:sid},
		success: function(response)
		{
			// console.log(response);
			// alert("Status Changed");
			$("#old_error").html(response);
		}
	})
}

function string_shuffle(string)
{
	var parts = string.split('');
    for (var i = parts.length; i > 0;) {
        var random = parseInt(Math.random() * i);
        var temp = parts[--i];
        parts[i] = parts[random];
        parts[random] = temp;
    }
    return parts.join('');
}

function GeneratePassword()
{
	var string = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz123456790";
	$("#input_generate").val(string_shuffle(string).substr(0, 10));
}

function ShowPassword()
{
	var input = $("#input_generate");
	var eye = $(".eye_btn i");

	if (eye.hasClass('fa fa-eye'))
	{
		eye.removeClass("fa fa-eye");
		eye.addClass("fa fa-eye-slash");
        input.attr('type', 'text');
    }
    else if (eye.hasClass('fa fa-eye-slash'))
    {
    	eye.removeClass("fa fa-eye-slash");
    	eye.addClass("fa fa-eye");
        input.attr('type', 'password');
    }
}

$(document).ready(function()
{
	$("#agreement_end_date").on('keyup keypress blur change', function()
	{
		var startDate = new Date($('#agreement_start_date').val());
		var endDate = new Date($(this).val());

		if (startDate > endDate)
		{
			alert("End date should be greater than start date.");
			$(this).val('');
		}
		else if($('#agreement_start_date').val() === '')
		{
			alert("Select start date first.");
			$(this).val('');
		}
	});
	
	$("#select_months").on('keyup change', function()
	{
	    var months = Number($(this).val());
	   // console.log(months);
	    var startDate = new Date($('#agreement_start_date').val());
        
        // var Day = startDate.setDate(startDate.getDate() - 5);
        var currentDay = startDate.getDate() - 1;
        var currentMonth = startDate.getMonth();
        
        startDate.setMonth(currentMonth + months, currentDay);
    
        if (startDate.getMonth() > currentMonth + months) {
            startDate.setDate(0);
        }
    
        var txtDay = moment(startDate).format('YYYY-MM-DD');  
        $("#agreement_end_date").val(txtDay);
        
        // console.log(Day);
	});
});

function isNumber(evt)
{
  evt = (evt) ? evt : window.event;
  var charCode = (evt.which) ? evt.which : evt.keyCode;
  if (charCode > 31 && (charCode < 48 || charCode > 57))
  {
    alert("Please enter only Numbers.");
    return false;
  }
  //phoneNo.value.length < 10 || phoneNo.value.length > 10              

  return true;
}

$(document).ready(function()
{
    $("#add_register").submit(function(e)
    {
        // $("#add_register").attr("disabled");
        var val = $("#token_no").val();
        
        if(val.length != 14)
        {
            alert("Token should be of 14 digits");
            // return false;
            $("#add_register_btn").attr("disabled", "disabled");
        }
        else
        {
            $.ajax({
        		type: "POST",
        		url: "check-token.php",
        		data: {token:val},
        		success: function(response)
        		{
        		    if( !$.trim(response) )
        		    {
        		        console.log("token_error is empty: "+response);
        		      //  $(this).submit();
        		        $("button[name='add_register']").removeAttr("disabled");
        		        
        		        
        		    }
        		    else
        		    {
        		       console.log("token_error is not empty: "+response);
        			    $("#token_error").html(response);
        			 //   e.preventDefault();
        			    $("#add_register_btn").attr("disabled", "disabled");
        		        
        		    }
        		}
        	});
        // 	return true;
            
        }
        // return false;
    });
    
    $("#update_register").submit(function(e)
    {
        var val = $("#token_no").val();
        
        if(val.length != 14)
        {
            alert("Token should be of 14 digits");
            return false;
        }
        else
        {
            $.ajax({
        		type: "POST",
        		url: "check-token.php",
        		data: {token:val, id:id},
        		success: function(response)
        		{
        			$("#token_error").html(response);
        		}
        	})
            return true;
        }
        return false;
    });
});

function CheckTokenLength(val)
{
    // console.log("id: "+id);
    if(val.length !== 14)
    {
        alert("Token should be of 14 digits");
        $("#add_register_btn").attr("disabled", "disabled");
        $("#upd_register_btn").attr("disabled", "disabled");
        // return false;
        
    }
}

function CheckToken(val,id)
{
    $.ajax({
		type: "POST",
		url: "check-token.php",
		data: {token:val, id:id},
		success: function(response)
		{
			$("#token_error").html(response);
			
			if( !$.trim(response) )
    		    {
    		        $("#add_register_btn").removeAttr("disabled");
    		        $("#upd_register_btn").removeAttr("disabled");
    		        
    		    }
    		    else
    		    {
    			    $("#token_error").html(response);
    			    $("#add_register_btn").attr("disabled", "disabled");
    			    $("#upd_register_btn").attr("disabled", "disabled");
    		        
    		    }
		}
	});
}

function LoadNotifyCount()
{
    $.ajax({
        url: 'count_notify.php', 
        success: function(html) {
            $(".count_notify").html( $.trim(html) );
        }
    });
}
// setInterval(LoadNotifyCount, 1000);